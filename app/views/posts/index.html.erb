<p id=”notice”><%= notice %></p>
<% if current_user %>
  Logged in as <%= current_user.username %>.
  <%= link_to 'Log Out', logout_path %>
  <%= link_to 'My Profile', profile_path %>
<% else %>
  <%= link_to 'Sign Up', signup_path %> or 
  <%= link_to 'Log In', login_path %>
<% end %>


<% @posts.each do |post| %>
<br>
 <% our_user = User.find(post[:user_id]) %>
 <%= our_user[:username] %>
  <p><%= post.message %></p>
  <%=post.created_at.to_formatted_s(:long)%>
  <% if can? :edit, post %>
    <%= link_to 'Edit', edit_post_path(post) %>
  <% end %>
  <% if can? :destroy, post %>
    <%= link_to 'Delete', post_path(post), method: :delete, data: { :confirm => "Are you sure?" } %>
  <% end %>
  <% if current_user %>
    <form action="<%= new_comment_path %>">     
    <input hidden value="<%= post.id %>" name="post_id">      <input type="Submit" value="Comment">  
    </form>
  <% end %>

  <% @comments.each do |comment| %>
    <% if comment.post_id == post.id %>
      <p><%= comment.comment %></p>
      <% if can? :edit, comment %>
        <%= link_to 'Edit', edit_comment_path(comment) %>
      <% end %>
      <% if can? :destroy, comment %>
        <%= link_to 'Delete', comment_path(comment), method: :delete, data: { :confirm => "Are you sure?" } %>
      <% end %>
    <% end %>
  <% end %>
<% end %>
<br>
<% if current_user %>
  <%= link_to new_post_path do %>
    New post
  <% end %>
<% end %>
